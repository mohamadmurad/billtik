import{a as h,j as e,S as g,J as b}from"./app-yHd38USP.js";import{E as f}from"./EditAction-xZ8sZLFd.js";import{S as y}from"./ShowAction-BmO0vNwZ.js";import{M as v}from"./m-datatable-CPnk25jU.js";import{B as m,t as s,a as j}from"./useTranslation-yCSdI_8k.js";import{P as C,f as _,g as k}from"./popover-BcRQRjo8.js";import{X as w}from"./x-D8ryCwNA.js";import{C as N}from"./check-CoweOkLA.js";import{B as P}from"./badge-CjVJkMmi.js";import{R as p}from"./refresh-cw-B0uljCbj.js";function K({id:a,resource:u,is_active:i,disabled:o=!1}){const[c,l]=h.useState(null),r=c===a,t=()=>{c!==null&&(d(c),l(null))},d=n=>{if(n)try{g.post(route(u+".toggle-active",n))}catch(x){console.error(`Failed to active ${u}:`,x)}};return e.jsxs(C,{open:r,onOpenChange:n=>l(n?a:null),children:[e.jsx(_,{asChild:!0,children:e.jsxs(m,{variant:"ghost",onClick:n=>{n.stopPropagation(),l(a)},disabled:o,children:[i?e.jsx(w,{size:20,className:"text-red-500"}):e.jsx(N,{size:20,className:"text-green-500"})," "]})}),e.jsxs(k,{className:"w-56 rounded-lg border border-gray-200 bg-white p-4 shadow-lg",children:[e.jsx("p",{className:"text-sm text-gray-700",children:s("messages.delete_alert")}),e.jsxs("div",{className:"mt-3 flex justify-end space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>l(null),children:s("attributes.cancel")}),e.jsx(m,{variant:"destructive",size:"sm",onClick:t,children:i?s("attributes.disable"):s("attributes.active")})]})]})]})}function L({resource:a}){const{items:u}=b().props,[i,o]=h.useState(!1);function c(r){if(r)try{o(!0),g.visit(route(a+".sync",r),{method:"post",onFinish:()=>o(!1)})}catch(t){console.error(`Failed to sync ${a}:`,t),o(!1)}}function l(){try{o(!0),g.visit(route(a+".sync-all"),{method:"post",onFinish:()=>o(!1)})}catch(r){console.error(`Failed to sync ${a}:`,r),o(!1)}}return e.jsx("div",{className:"px-4 py-6",children:e.jsx(v,{items:u,createButton:!0,beforeCreateBtnContent:e.jsxs(m,{variant:"default",className:"px-8 py-5 text-[16px] font-extrabold",onClick:r=>{r.stopPropagation(),l()},disabled:i,children:[e.jsx(p,{size:20,className:""}),s("attributes.fetch_from_microtik")]}),resource:a,columns:[{accessorKey:"router.name",header:s("attributes.router")},{accessorKey:"name",header:s("attributes.name")},{accessorKey:"is_active",header:s("attributes.status"),cell:({row:r})=>{const t=r.original,d=t.is_active?"bg-green-50 dark:bg-green-950/20":"bg-gray-50 dark:bg-gray-950/20",n=t.is_active?"text-green-700 dark:text-green-300":"text-gray-700 dark:text-gray-300",x=t.is_active?s("attributes.active"):s("attributes.disabled");return e.jsx(P,{className:j("border-0 text-xs font-medium shadow-lg",d,n),children:x})}},{accessorKey:"download_formatted",header:s("attributes.download_limit")},{accessorKey:"upload_formatted",header:s("attributes.upload_limit")},{accessorKey:"price_formatted",header:s("attributes.price")},{accessorKey:"created_at",header:s("attributes.created_at")},{id:"actions",header:s("attributes.actions"),cell:({row:r})=>{const t=r.original;return e.jsxs("div",{className:"flex",children:[t.abilities.need_sync&&e.jsx(m,{title:s("attributes.sync"),variant:"ghost",onClick:d=>{d.stopPropagation(),c(t.id)},disabled:i,children:e.jsx(p,{size:20,className:"text-green-500"})}),t.abilities.view&&e.jsx(y,{resource:a,rowModel:t,disabled:i}),t.abilities.edit&&e.jsx(f,{rowModel:t,resource:a,disabled:i}),t.abilities.toggleActive&&e.jsx(K,{id:t.id,is_active:t.is_active,resource:a,disabled:i})]})}}]})})}export{L as P};
