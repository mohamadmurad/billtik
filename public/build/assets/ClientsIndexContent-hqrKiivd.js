import{a as h,S as f,J as y,j as r}from"./app-EG-PheeV.js";import{E as b}from"./EditAction-BWDm6XyX.js";import{S as j,D as v}from"./table-CrG8O8ym.js";import{M as F}from"./m-datatable-BfeqUhu5.js";import{M as S}from"./MSelect-dqT8ZQls.js";import{t as a,B as g}from"./useTranslation-BrUf7vuw.js";import{R as w}from"./refresh-cw-B0qfLlcR.js";function _(s={},n){const[o,c]=h.useState(s),[l,d]=h.useState(!0);h.useEffect(()=>{if(l){const i=new URLSearchParams(window.location.search),t={};Object.keys(s).forEach(e=>{i.has(e)&&(t[e]=i.get(e))}),c(e=>({...e,...t})),d(!1)}},[l,s]);const m=()=>{const i=Object.fromEntries(Object.entries(o).filter(([t,e])=>e!==""&&e!==void 0));f.get(route(n+".index",i),{preserveState:!0,replace:!0,only:["items"],onFinish:()=>{window.history.replaceState({},"",route(n+".index",i))}})},p=()=>{c(s),f.get(route(n+".index"),{preserveState:!0,replace:!0,only:["items"]})},u=Object.entries(o).some(([i,t])=>t!==void 0&&t!==""&&t!==s[i]);return{filters:o,setFilters:c,applyFilters:m,resetFilters:p,isFiltersActive:u}}function P({resource:s}){const{items:n}=y().props,{filters:o,setFilters:c,applyFilters:l,resetFilters:d,isFiltersActive:m}=_({search:"",router_id:""},s),p=o;function u(t){if(t)try{f.visit(route(s+".sync",t),{method:"post"})}catch(e){console.error(`Failed to sync ${s}:`,e)}}const i=r.jsx("div",{className:"min-w-[300px] space-y-4",children:r.jsx("div",{className:"grid gap-2",children:r.jsx(S,{label:a("attributes.router"),value:String(p.router_id),apiUrl:route("company.routers.search"),inputProps:{id:"router"},onChange:t=>c({...o,router_id:String(t)})})})});return r.jsx("div",{className:"px-4 py-6",children:r.jsx(F,{items:n,resource:s,columns:[{accessorKey:"router.name",header:a("attributes.router")},{accessorKey:"name",header:a("attributes.name")},{accessorKey:"mikrotik_username",header:a("attributes.username")},{accessorKey:"email",header:a("attributes.email")},{accessorKey:"phone",header:a("attributes.phone")},{accessorKey:"created_at",header:a("attributes.created_at")},{id:"actions",header:a("attributes.actions"),cell:({row:t})=>{const e=t.original;return r.jsxs("div",{className:"flex",children:[e.abilities.need_sync&&r.jsx(g,{title:a("attributes.sync"),variant:"ghost",onClick:x=>{x.stopPropagation(),u(e.id)},children:r.jsx(w,{size:20,className:"text-green-500"})}),e.abilities.view&&r.jsx(j,{resource:s,rowModel:e}),e.abilities.edit&&r.jsx(b,{rowModel:e,resource:s}),e.abilities.delete&&r.jsx(v,{id:e.id,resource:s})]})}}],filterComponents:i,filtersActive:m,onFilterApply:l,onFilterReset:d})})}export{P as C};
